{"ast":null,"code":"var _jsxFileName = \"E:\\\\BarberApp\\\\src\\\\context\\\\AppointmentsContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\nimport { supabase } from '../utils/supabase';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AppointmentsContext = /*#__PURE__*/createContext(null);\nexport const TIME_SLOTS = ['09:00', '09:30', '10:00', '10:30', '11:00', '11:30', '12:00', '12:30', '14:00', '14:30', '15:00', '15:30', '16:00', '16:30', '17:00', '17:30', '18:00', '18:30'];\nexport const SERVICES = [{\n  id: 'corte',\n  name: 'Corte de Cabello',\n  duration: 30,\n  price: 2500\n}, {\n  id: 'barba',\n  name: 'Arreglo de Barba',\n  duration: 30,\n  price: 1800\n}, {\n  id: 'combo',\n  name: 'Corte + Barba',\n  duration: 60,\n  price: 3800\n}, {\n  id: 'cejas',\n  name: 'Perfilado de Cejas',\n  duration: 15,\n  price: 800\n}];\nexport function AppointmentsProvider({\n  children\n}) {\n  _s();\n  const [appointments, setAppointments] = useState([]);\n  const fetchAppointments = useCallback(async () => {\n    const {\n      data,\n      error\n    } = await supabase.from('appointments').select('*').order('date', {\n      ascending: true\n    });\n    if (!error && data) {\n      // Normalize snake_case to camelCase\n      setAppointments(data.map(a => ({\n        id: a.id,\n        userId: a.user_id,\n        userName: a.user_name,\n        userEmail: a.user_email,\n        date: a.date,\n        time: a.time,\n        serviceId: a.service_id,\n        serviceName: a.service_name,\n        price: a.price,\n        status: a.status,\n        createdAt: a.created_at\n      })));\n    }\n  }, []);\n  useEffect(() => {\n    fetchAppointments();\n\n    // Suscripción en tiempo real\n    const channel = supabase.channel('appointments-changes').on('postgres_changes', {\n      event: '*',\n      schema: 'public',\n      table: 'appointments'\n    }, fetchAppointments).subscribe();\n    return () => supabase.removeChannel(channel);\n  }, [fetchAppointments]);\n  const getSlotAvailability = (date, time) => {\n    return !appointments.find(a => a.date === date && a.time === time && a.status !== 'cancelled');\n  };\n  const createAppointment = async appt => {\n    const {\n      data,\n      error\n    } = await supabase.from('appointments').insert([{\n      user_id: appt.userId,\n      user_name: appt.userName,\n      user_email: appt.userEmail,\n      date: appt.date,\n      time: appt.time,\n      service_id: appt.serviceId,\n      service_name: appt.serviceName,\n      price: appt.price,\n      status: appt.status || 'confirmed'\n    }]).select().single();\n    if (error) {\n      console.error(error);\n      return null;\n    }\n    await fetchAppointments();\n    return {\n      ...appt,\n      id: data.id\n    };\n  };\n  const updateAppointment = async (id, updates) => {\n    const dbUpdates = {};\n    if (updates.userName !== undefined) dbUpdates.user_name = updates.userName;\n    if (updates.userEmail !== undefined) dbUpdates.user_email = updates.userEmail;\n    if (updates.date !== undefined) dbUpdates.date = updates.date;\n    if (updates.time !== undefined) dbUpdates.time = updates.time;\n    if (updates.serviceId !== undefined) dbUpdates.service_id = updates.serviceId;\n    if (updates.serviceName !== undefined) dbUpdates.service_name = updates.serviceName;\n    if (updates.price !== undefined) dbUpdates.price = updates.price;\n    if (updates.status !== undefined) dbUpdates.status = updates.status;\n    await supabase.from('appointments').update(dbUpdates).eq('id', id);\n    await fetchAppointments();\n  };\n  const deleteAppointment = async id => {\n    await supabase.from('appointments').delete().eq('id', id);\n    await fetchAppointments();\n  };\n  const getAppointmentsByDate = date => {\n    return appointments.filter(a => a.date === date && a.status !== 'cancelled');\n  };\n  const getUserAppointments = userId => {\n    return appointments.filter(a => a.userId === userId);\n  };\n  return /*#__PURE__*/_jsxDEV(AppointmentsContext.Provider, {\n    value: {\n      appointments,\n      fetchAppointments,\n      getSlotAvailability,\n      createAppointment,\n      updateAppointment,\n      deleteAppointment,\n      getAppointmentsByDate,\n      getUserAppointments\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 5\n  }, this);\n}\n_s(AppointmentsProvider, \"CWD/b2yvCcg3TGMqWGJA0MvYT5Y=\");\n_c = AppointmentsProvider;\nexport const useAppointments = () => {\n  _s2();\n  return useContext(AppointmentsContext);\n};\n_s2(useAppointments, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AppointmentsProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useCallback","supabase","jsxDEV","_jsxDEV","AppointmentsContext","TIME_SLOTS","SERVICES","id","name","duration","price","AppointmentsProvider","children","_s","appointments","setAppointments","fetchAppointments","data","error","from","select","order","ascending","map","a","userId","user_id","userName","user_name","userEmail","user_email","date","time","serviceId","service_id","serviceName","service_name","status","createdAt","created_at","channel","on","event","schema","table","subscribe","removeChannel","getSlotAvailability","find","createAppointment","appt","insert","single","console","updateAppointment","updates","dbUpdates","undefined","update","eq","deleteAppointment","delete","getAppointmentsByDate","filter","getUserAppointments","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAppointments","_s2","$RefreshReg$"],"sources":["E:/BarberApp/src/context/AppointmentsContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\nimport { supabase } from '../utils/supabase';\n\nconst AppointmentsContext = createContext(null);\n\nexport const TIME_SLOTS = [\n  '09:00', '09:30', '10:00', '10:30', '11:00', '11:30',\n  '12:00', '12:30', '14:00', '14:30', '15:00', '15:30',\n  '16:00', '16:30', '17:00', '17:30', '18:00', '18:30'\n];\n\nexport const SERVICES = [\n  { id: 'corte', name: 'Corte de Cabello', duration: 30, price: 2500 },\n  { id: 'barba', name: 'Arreglo de Barba', duration: 30, price: 1800 },\n  { id: 'combo', name: 'Corte + Barba', duration: 60, price: 3800 },\n  { id: 'cejas', name: 'Perfilado de Cejas', duration: 15, price: 800 },\n];\n\nexport function AppointmentsProvider({ children }) {\n  const [appointments, setAppointments] = useState([]);\n\n  const fetchAppointments = useCallback(async () => {\n    const { data, error } = await supabase\n      .from('appointments')\n      .select('*')\n      .order('date', { ascending: true });\n    if (!error && data) {\n      // Normalize snake_case to camelCase\n      setAppointments(data.map(a => ({\n        id: a.id,\n        userId: a.user_id,\n        userName: a.user_name,\n        userEmail: a.user_email,\n        date: a.date,\n        time: a.time,\n        serviceId: a.service_id,\n        serviceName: a.service_name,\n        price: a.price,\n        status: a.status,\n        createdAt: a.created_at,\n      })));\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchAppointments();\n\n    // Suscripción en tiempo real\n    const channel = supabase\n      .channel('appointments-changes')\n      .on('postgres_changes', { event: '*', schema: 'public', table: 'appointments' }, fetchAppointments)\n      .subscribe();\n\n    return () => supabase.removeChannel(channel);\n  }, [fetchAppointments]);\n\n  const getSlotAvailability = (date, time) => {\n    return !appointments.find(a => a.date === date && a.time === time && a.status !== 'cancelled');\n  };\n\n  const createAppointment = async (appt) => {\n    const { data, error } = await supabase\n      .from('appointments')\n      .insert([{\n        user_id: appt.userId,\n        user_name: appt.userName,\n        user_email: appt.userEmail,\n        date: appt.date,\n        time: appt.time,\n        service_id: appt.serviceId,\n        service_name: appt.serviceName,\n        price: appt.price,\n        status: appt.status || 'confirmed',\n      }])\n      .select()\n      .single();\n\n    if (error) { console.error(error); return null; }\n    await fetchAppointments();\n    return { ...appt, id: data.id };\n  };\n\n  const updateAppointment = async (id, updates) => {\n    const dbUpdates = {};\n    if (updates.userName !== undefined) dbUpdates.user_name = updates.userName;\n    if (updates.userEmail !== undefined) dbUpdates.user_email = updates.userEmail;\n    if (updates.date !== undefined) dbUpdates.date = updates.date;\n    if (updates.time !== undefined) dbUpdates.time = updates.time;\n    if (updates.serviceId !== undefined) dbUpdates.service_id = updates.serviceId;\n    if (updates.serviceName !== undefined) dbUpdates.service_name = updates.serviceName;\n    if (updates.price !== undefined) dbUpdates.price = updates.price;\n    if (updates.status !== undefined) dbUpdates.status = updates.status;\n\n    await supabase.from('appointments').update(dbUpdates).eq('id', id);\n    await fetchAppointments();\n  };\n\n  const deleteAppointment = async (id) => {\n    await supabase.from('appointments').delete().eq('id', id);\n    await fetchAppointments();\n  };\n\n  const getAppointmentsByDate = (date) => {\n    return appointments.filter(a => a.date === date && a.status !== 'cancelled');\n  };\n\n  const getUserAppointments = (userId) => {\n    return appointments.filter(a => a.userId === userId);\n  };\n\n  return (\n    <AppointmentsContext.Provider value={{\n      appointments,\n      fetchAppointments,\n      getSlotAvailability,\n      createAppointment,\n      updateAppointment,\n      deleteAppointment,\n      getAppointmentsByDate,\n      getUserAppointments,\n    }}>\n      {children}\n    </AppointmentsContext.Provider>\n  );\n}\n\nexport const useAppointments = () => useContext(AppointmentsContext);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}